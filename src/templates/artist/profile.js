import React from "react";
import { get } from "lodash";
import { graphql } from "gatsby";

import Main from "../../layouts/Main";
import ArtistHeader from "../../components/artist/ArtistHeader";
import ArtistProfile from "../../components/artist/ArtistProfile";
import ArtistSocial from "../../components/artist/ArtistSocial";

export default ({ data }) => {
  const dropInfo = get(data, "allSitePage.edges[0].node.context");
  return (
    <Main>
      {() => (
        <>
          <ArtistHeader dropInfo={dropInfo} />
          <ArtistProfile dropInfo={dropInfo} />
          <ArtistSocial dropInfo={dropInfo} />
        </>
      )}
    </Main>
  );
};

export const query = graphql`
  query($path: String!) {
    allSitePage(filter: { path: { eq: $path } }) {
      edges {
        node {
          context {
            id
            title
            slug
            artist
            handle
            smallImage
            featuredImage
            aboutArtist
            twitter
            instagram
            recentWork {
              image
              title
              description
              link
            }
          }
        }
      }
    }
  }
`;
